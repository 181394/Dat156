<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Uke 2 - Backend og conditionals | Dat156</title>
    <meta name="description" content="Praksis for data">
    
    
    <link rel="preload" href="/Dat156/assets/css/0.styles.004837a5.css" as="style"><link rel="preload" href="/Dat156/assets/js/app.cf80f155.js" as="script"><link rel="preload" href="/Dat156/assets/js/5.74bd4a91.js" as="script"><link rel="prefetch" href="/Dat156/assets/js/10.0831797f.js"><link rel="prefetch" href="/Dat156/assets/js/2.3badc248.js"><link rel="prefetch" href="/Dat156/assets/js/3.e734cabc.js"><link rel="prefetch" href="/Dat156/assets/js/4.a63b801d.js"><link rel="prefetch" href="/Dat156/assets/js/6.1547b7a1.js"><link rel="prefetch" href="/Dat156/assets/js/7.31977881.js"><link rel="prefetch" href="/Dat156/assets/js/8.edc11b7e.js"><link rel="prefetch" href="/Dat156/assets/js/9.6d453cdf.js">
    <link rel="stylesheet" href="/Dat156/assets/css/0.styles.004837a5.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/Dat156/" class="home-link router-link-active"><!----> <span class="site-name">Dat156</span></a> <div class="links" style="max-width:nullpx;"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/Dat156/" class="nav-link">Home</a></div><div class="nav-item"><a href="https://www.github.com/181394/Dat156/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><a href="https://scoutgaminggroup.com/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  ScoutGG
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <div class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/Dat156/" class="nav-link">Home</a></div><div class="nav-item"><a href="https://www.github.com/181394/Dat156/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><a href="https://scoutgaminggroup.com/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  ScoutGG
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav>  <ul class="sidebar-links"><li><a href="/Dat156/uke6/" class="sidebar-link">Uke 6 - Finpussing og avrunding</a></li><li><a href="/Dat156/uke5/" class="sidebar-link">Uke 5 - Tilbake til klienten</a></li><li><a href="/Dat156/uke4/" class="sidebar-link">Uke 4 - Implementasjon i Python</a></li><li><a href="/Dat156/uke3/" class="sidebar-link">Uke 3 - Tidsbegrensing og filtrering</a></li><li><a href="/Dat156/uke2/" class="active sidebar-link">Uke 2 - Backend og conditionals</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/Dat156/uke2/#fredag" class="sidebar-link">Fredag</a></li><li class="sidebar-sub-header"><a href="/Dat156/uke2/#torsdag" class="sidebar-link">Torsdag</a></li><li class="sidebar-sub-header"><a href="/Dat156/uke2/#onsdag" class="sidebar-link">Onsdag</a></li><li class="sidebar-sub-header"><a href="/Dat156/uke2/#tirsdag" class="sidebar-link">Tirsdag</a></li><li class="sidebar-sub-header"><a href="/Dat156/uke2/#mandag" class="sidebar-link">Mandag</a></li></ul></li><li><a href="/Dat156/uke1/" class="sidebar-link">Uke 1 - Rammeverk og hodeverk</a></li></ul> </div> <div class="page"> <div class="content"><h1 id="uke-2"><a href="#uke-2" aria-hidden="true" class="header-anchor">#</a> Uke 2</h1> <div class="tip custom-block"><p class="custom-block-title">Timer</p> <p>Denne uken: 42</p></div> <h2 id="fredag"><a href="#fredag" aria-hidden="true" class="header-anchor">#</a> Fredag</h2> <p>Arbeidsuken er over og helgen kan snart begynne!
Idag har jeg jobbet videre med gårdagens utløpsdato-oppgave. Dagen har for det meste gått til å sette opp serversiden slik at den kan ta imot HTTP-requests, for å bruke <strong><em>Postman</em></strong> for å sjekke at responsen kommer tilbake i riktig format og at ingenting går gale.
Videre har jeg lagt til valgfri datostempling av <em>features</em> man legger til fra brukerkrensesnittet (ja jeg har klart å rote meg tilbake på klientsiden). Jeg har og endret koden på serversiden slik at alle <em>features</em> som er utgått på dato ikke sendes fra server i det heletatt, men fortsatt ligger i databasen. Dette gjør at programmet ikke tar unødvendig mye tid å laste og det er enkelt å hente frem historikk.</p> <h2 id="torsdag"><a href="#torsdag" aria-hidden="true" class="header-anchor">#</a> Torsdag</h2> <p>Idag har jeg lagt til en debugger for mocha og chai i VS code, for å finne ut hva som går gale i koden min og etter mye frem og tilbake mellom linjene fant jeg ut av det. Nå fungerer &quot;IF&quot; kommandoen helt knirkefritt (hvertfall etter hva jeg har klart å teste). Jeg var egentlig nokså ferdig med den opprinnelige oppgaven nå, men det har kommet et par ekstra ønskelige funksjoner på bordet.</p> <p>De nye funskjonene jeg skal implementere er å legge til mulighet for utløpsdato på forskjellige <em>features</em>. Dette vil brukes ved tidsbegrensede arrangement, som f.eks VM eller OL. I tillegg ønsket de en måte å søke på forskjellige <em>features</em>, slik at det blir enklere å finne fram etterhvert som det blir lagt inn mer og mer i databasen.</p> <p>Jeg begynte såvidt på implementasjonen av utløpsdato i dag, ved å legge til en kollonne av typen <strong>TIMESTAMPTZ</strong> i databasen. Den fungerer direkte med Javascript sine Date objekter som igjen er kompatibel med sammenlignings operatørene: <strong>&lt;</strong> og <strong>&gt;</strong>. Dette gjør det svært enkelt å teste om en gitt dato er passert.</p> <h2 id="onsdag"><a href="#onsdag" aria-hidden="true" class="header-anchor">#</a> Onsdag</h2> <p>Idag var Henrik tilbake, så jeg har brukt litt tid på å ta ham gjennom det jeg har gjort på front-end delen.
Ellers har jeg jobbet masse med &quot;IF&quot; kommandoen til config'en, men da jeg viste frem arbeidet fikk jeg beskjed om at jeg hadde tolket problemstillingen feil. Så da skrotet jeg det meste av arbeidet og begynte på nytt. Etter en stund var jeg nokså fornøyd og skulle begynne å teste, men testene stemmer ikke helt overens med det jeg forventet, da de alltid viser godkjent, selv når de absolutt ikke skal. Jeg mistenker at dette kan være grunnet mindre forståelse for Node.js sin module.exports funksjon fra min side, så det blir hjemmelekse for meg å sette meg inn i dette.</p> <p>I håp om å unngå tilsvarende senere vil jeg nok bruke store deler av morgendagen på å sette meg inn i Node.js og Express.js. Dette er og svært relevant for bacheloroppgaven min så der har jeg litt ekstra motivasjon.</p> <h2 id="tirsdag"><a href="#tirsdag" aria-hidden="true" class="header-anchor">#</a> Tirsdag</h2> <p>Denne uken er visst noe forskjøvet, da mandagen kom på tirsdag.
Idag forsov jeg meg litt, så jeg skyntet meg ut og mistet bybanen akkurat og måtte vente i vel 8 min på neste. Jeg fikk meg en god plass og satt meg godt til rette. Så etter et par stopp får vi beskjed om at det er teknisk feil på bybanen og alle må av og vente på neste. Heldigvis var det nå mange som ventet på den neste vognen, som også var ganske full. Så turen endte opp med å stå som sild i tønne med tjukk boblejakke på. 😒</p> <p>Ellers har dagen vært noe dramatisk på Scout. Midt i lunsjen kom det en løpende og skrek ut &quot;CODE RED! ALT ER NEDE!&quot; og alle hoppet opp å kom seg tilbake på plass for å finne problemene og restarte serverne. De har satt opp en raspberry pie til å overvåke alle serverne de har og vise status på en skjerm midt i det åpne landskapet hvor alle utviklerne sitter, og alt lyste rødt. Jeg fikk inntrykk av å være med i en episode av tv-serien &quot;Silicon Valley&quot;. Heldigvis gikk det ikke lange tiden før alt var oppe igjen.</p> <p>Idag har jeg skrevet ferdig sql-spørringen fra server, som oppdaterer alle endringer gjort fra klienten i en engang, og den fungerer knirkefritt.
Jeg har og gått i dybden og analysert flyten i programmet for å få ordentlig oversikt over hvordan konfigurasjonen fra databasen blir håndtert på serveren. Jeg begynner å bli klar for å skrive logikken bak if'statementene.</p> <h2 id="mandag"><a href="#mandag" aria-hidden="true" class="header-anchor">#</a> Mandag</h2> <p>Idag har jeg hatt en god dag. Jeg har fått skrotet mye unødvendig og dårlig kode, og erstattet det med korte og lettleselige funksjoner.
På klient-siden får jeg nå sendt alle endringer i ett flott og lett håndterlig json objekt. På serversiden har jeg begynt å lage en sql spørring (query) for å oppdaterer alle endringer i en engang, istedenfor å ha det i en løkke (noe som kan bli svært tidkrevende om mange endringer blir gjort).</p> <p>Jeg har og begynt å skrive tester for &quot;If&quot; statementene Scout ønsker i config-databasen sin. Disse skal igrunn fungere på samme vis som en &quot;if&quot; statement i alle språk, men den skal skrives i json.
Mulige implementasjoner:</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// AND-case</span>
<span class="token comment">// $ - signaliserer et uttrykk som skal evalueres</span>

<span class="token comment">// Her ligger betingelsene i samme json objekt.</span>
<span class="token comment">// Dette indikerer at alle betingelsene må være</span>
<span class="token comment">// oppfylt for at uttrykket skal evaluere &quot;then&quot; klausulen,</span>
<span class="token comment">// ellers evalueres &quot;else&quot; klausulen.</span>


<span class="token comment">// Dette eksempelet vil gi kr 20.000,- i spendinglimit</span>
<span class="token comment">// til 30% av brukerne, og kr 10.000,- til resten</span>
<span class="token punctuation">{</span>
  <span class="token string">&quot;myFeature&quot;</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>

    <span class="token string">&quot;$Spendinglimit&quot;</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
      <span class="token string">&quot;if&quot;</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
        <span class="token string">&quot;test&quot;</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
          <span class="token string">&quot;role&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;user&quot;</span><span class="token punctuation">,</span>    <span class="token comment">// IF has role user</span>
          <span class="token string">&quot;percentage&quot;</span><span class="token punctuation">:</span> <span class="token number">30</span>   <span class="token comment">// AND is within 30% of all users</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token string">&quot;then&quot;</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
          <span class="token string">&quot;limit&quot;</span><span class="token punctuation">:</span> <span class="token number">20000</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token string">&quot;else&quot;</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
          <span class="token string">&quot;limit&quot;</span><span class="token punctuation">:</span> <span class="token number">10000</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// Her ligger betingelsene i en tabell (Array) i et json objekt.</span>
<span class="token comment">// Dette indikerer at minst ett av betingelsene må være</span>
<span class="token comment">// oppfylt for at uttrykket skal evaluere &quot;then&quot; klausulen,</span>
<span class="token comment">// ellers evalueres &quot;else&quot; klausulen.</span>

<span class="token comment">// Dette eksempelet vil gi kr 20.000,- i spendinglimit</span>
<span class="token comment">// til alle admin-brukere og 20% av brukerne</span>
<span class="token comment">// og kr 10.000,- til resten</span>
<span class="token punctuation">{</span>
  <span class="token string">&quot;myFeature&quot;</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>

    <span class="token string">&quot;$Spendinglimit&quot;</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
      <span class="token string">&quot;if&quot;</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
        <span class="token string">&quot;test&quot;</span><span class="token punctuation">:</span> <span class="token punctuation">[</span>
          <span class="token punctuation">{</span><span class="token string">&quot;role&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;admin&quot;</span><span class="token punctuation">}</span><span class="token punctuation">,</span>   <span class="token comment">// IF has role admin</span>
          <span class="token punctuation">{</span><span class="token string">&quot;percentage&quot;</span><span class="token punctuation">:</span> <span class="token number">20</span><span class="token punctuation">}</span>   <span class="token comment">// OR is within 20% of all users</span>
        <span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token string">&quot;then&quot;</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
          <span class="token string">&quot;limit&quot;</span><span class="token punctuation">:</span> <span class="token number">20000</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token string">&quot;else&quot;</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
          <span class="token string">&quot;limit&quot;</span><span class="token punctuation">:</span> <span class="token number">10000</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div></div> <div class="page-edit"><!----> <div class="last-updated"><span class="prefix">Sist oppdatert: </span> <span class="time">2/27/2019, 2:59:42 PM</span></div></div> <div class="page-nav"><p class="inner"><span class="prev">
        ←
        <a href="/Dat156/uke3/" class="prev">
          Uke 3 - Tidsbegrensing og filtrering
        </a></span> <span class="next"><a href="/Dat156/uke1/">
          Uke 1 - Rammeverk og hodeverk
        </a>
        →
      </span></p></div> </div> <!----></div></div>
    <script src="/Dat156/assets/js/app.cf80f155.js" defer></script><script src="/Dat156/assets/js/5.74bd4a91.js" defer></script>
  </body>
</html>
